<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register</title>
    <link rel="stylesheet" href="registration1.css">
</head>
<body>
    <div class="Heading">
        <center><h1>Register</h1></center>
    </div>
    <form class="userDetails" id="registrationForm">
        <label class="firstName">First Name: </label>
        <input class="firstNameInput" type="text" id="firstName" required>
        <small id="firstNameHint" class="hint"></small>
        <p></p>

        <label class="lastName">Last Name: </label>
        <input class="lastNameInput" type="text" id="lastName" required>
        <small id="lastNameHint" class="hint"></small>
        <p></p>

        <label class="gender">Gender: </label>
        <select id="genders" name="genders" required>
            <option value="None">None</option>
            <option value="Female">Female</option>
            <option value="Male">Male</option>
            <option value="Others">Others</option>
        </select>
        <p></p>

        <label class="course">Branch: </label>
        <select id="courses" name="courses" required>
            <option value="None">None</option>
            <option value="CSE">CSE</option>
            <option value="CSE (AIML)">CSE (AIML)</option>
            <option value="IT">IT</option>
            <option value="ECE">ECE</option>
            <option value="EEE">EEE</option>
        </select>
        <p></p>

        <label class="userName">UserName: </label>
        <input class="userNameInput" type="text" id="userName" required>
        <small id="userNameHint" class="hint"></small>
        <p></p>

        <label class="password">Password: </label>
        <input class="passwordInput" type="password" id="password" required>
        <p></p>

        <label class="confirmPassword">Confirm Password: </label>
        <input class="confirmPasswordInput" type="password" id="confirmPassword" required>
        <p></p>

        <label class="state">State: </label>
        <input class="stateInput" type="text" id="state" required>
        <small id="stateHint" class="hint"></small>
        <p></p>

        <label class="country">Country: </label>
        <input class="countryInput" type="text" id="country" required>
        <small id="countryHint" class="hint"></small>
        <p></p>

        <label class="dob">Date of Birth: </label>
        <input class="dobInput" type="date" id="dob" required>
        <p></p>
    </form>
    <p></p>
    <center>
        <button class="reset" type="reset" onclick="resetForm()">Reset</button>
        <button class="submit" type="submit" onclick="validateForm(event)">Submit</button>
    </center>
    <p></p>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const firstNameInput = document.getElementById('firstName');
            const lastNameInput = document.getElementById('lastName');
            const userNameInput = document.getElementById('userName');
            const stateInput = document.getElementById('state');
            const countryInput = document.getElementById('country');

            const namePattern = /^[A-Za-z]*$/;
            const usernamePattern = /^[A-Za-z0-9_]*$/;

            firstNameInput.addEventListener("input", function () {
                validateLive(this, namePattern, "firstNameHint", "Only alphabets allowed.");
            });

            lastNameInput.addEventListener("input", function () {
                validateLive(this, namePattern, "lastNameHint", "Only alphabets allowed.");
            });

            userNameInput.addEventListener("input", function () {
                if (this.value.length < 5) {
                    setHint(this, "userNameHint", "Minimum 5 characters.", false);
                } else {
                    validateLive(this, usernamePattern, "userNameHint", "Only letters, numbers, and underscores allowed.");
                }
            });

            stateInput.addEventListener("input", function () {
                validateLive(this, namePattern, "stateHint", "Only alphabets allowed.");
            });

            countryInput.addEventListener("input", function () {
                validateLive(this, namePattern, "countryHint", "Only alphabets allowed.");
            });
        });

        function validateLive(inputElement, pattern, hintId, hintText) {
            if (pattern.test(inputElement.value)) {
                setHint(inputElement, hintId, "", true);
            } else {
                setHint(inputElement, hintId, hintText, false);
            }
        }

        function setHint(inputElement, hintId, message, isValid) {
            const hint = document.getElementById(hintId);
            hint.textContent = message;
            if (isValid) {
                inputElement.classList.add("valid");
                inputElement.classList.remove("invalid");
            } else {
                inputElement.classList.add("invalid");
                inputElement.classList.remove("valid");
            }
        }

        function validateLive(inputElement, pattern, hintId, hintText) {
            if (pattern.test(inputElement.value)) {
                setHint(inputElement, hintId, "", true);
            } else {
                setHint(inputElement, hintId, hintText, false);
            }
        }

        function setHint(inputElement, hintId, message, isValid) {
            const hint = document.getElementById(hintId);
            hint.textContent = message;
            if (isValid) {
                inputElement.classList.add("valid");
                inputElement.classList.remove("invalid");
            } else {
                inputElement.classList.add("invalid");
                inputElement.classList.remove("valid");
            }
        }

        // Function to validate form
        function validateForm(event) {
            event.preventDefault(); // Prevent form submission to handle validation

            // Get form values
            var firstName = document.getElementById('firstName').value;
            var lastName = document.getElementById('lastName').value;
            var userName = document.getElementById('userName').value;
            var password = document.getElementById('password').value;
            var confirmPassword = document.getElementById('confirmPassword').value;
            var dob = document.getElementById('dob').value;

            // Validate first and last names (only alphabets)
            var namePattern = /^[A-Za-z]+$/;
            if (!namePattern.test(firstName)) {
                alert("First name should only contain alphabets.");
                return false;
            }
            if (!namePattern.test(lastName)) {
                alert("Last name should only contain alphabets.");
                return false;
            }

            // Validate username (minimum 5 characters, alphanumeric and underscores only)
            var usernamePattern = /^[A-Za-z0-9_]{5,}$/;
            if (!usernamePattern.test(userName)) {
                alert("Username must be at least 5 characters and contain only alphabets, numbers, and underscores.");
                return false;
            }

            // Validate password and confirm password match
            if (password !== confirmPassword) {
                alert("Password and Confirm Password must match.");
                return false;
            }

            // Validate age (must be at least 18 years old)
            var age = calculateAge(dob);
            if (age < 18) {
                alert("You must be at least 18 years old to register.");
                return false;
            }

            // If all validations pass, submit the form (can be handled with backend logic)
            alert("Registration successful!");
            return true;
        }

        // Function to calculate age from the date of birth
        function calculateAge(dob) {
            var birthDate = new Date(dob);
            var currentDate = new Date();
            var age = currentDate.getFullYear() - birthDate.getFullYear();
            var month = currentDate.getMonth() - birthDate.getMonth();
            if (month < 0 || (month === 0 && currentDate.getDate() < birthDate.getDate())) {
                age--;
            }
            return age;
        }

        // Reset form function
        function resetForm() {
            document.getElementById("registrationForm").reset();

            // Remove all 'valid' and 'invalid' classes and clear hint texts
            const inputs = document.querySelectorAll("#registrationForm input");
            const hints = document.querySelectorAll(".hint");

            inputs.forEach(input => {
                input.classList.remove("valid");
                input.classList.remove("invalid");
            });

            hints.forEach(hint => {
                hint.textContent = "";
            });
        }

    </script>
</body>
</html>
